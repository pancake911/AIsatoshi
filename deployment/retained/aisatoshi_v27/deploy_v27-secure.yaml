---
# ==============================================================================
# AIsatoshi V27-SECURE - Akashéƒ¨ç½²é…ç½®
# ==============================================================================
#
# ğŸ“‹ ç‰ˆæœ¬å†å² (Version History):
# ==============================================================================
#
# V27-SECURE (2025-02-14)
# ------------------------
# ğŸ”’ å®‰å…¨ä¿®å¤ç‰ˆæœ¬
# âœ… æ·»åŠ  .dockerignore é˜²æ­¢æ•æ„Ÿæ–‡ä»¶è¢«æ‰“åŒ…è¿› Docker é•œåƒ
# âœ… ä¿®å¤ç§é’¥æ³„éœ²é—®é¢˜ - deploy_v27.yaml ä¸å†åŒ…å«åœ¨é•œåƒä¸­
# âœ… éªŒè¯é•œåƒä¸­æ— æ•æ„Ÿ YAML/ENV æ–‡ä»¶
#
# V27 (2025-02-14)
# ----------------
# ğŸš€ å…¨æ–°æ¶æ„ V27 - å®Œå…¨é‡å†™ï¼ŒéåŸºäº V26+ ä¿®æ”¹
# âœ… è®°å¿†åŸç”Ÿç³»ç»Ÿ - æ‰€æœ‰å¯¹è¯æŒä¹…åŒ–å­˜å‚¨
# âœ… ä»»åŠ¡ç»§æ‰¿åŸç”Ÿ - é‡å¯åè‡ªåŠ¨æ¢å¤æœªå®Œæˆä»»åŠ¡
# âœ… è¿›åŒ–å­¦ä¹ åŸç”Ÿ - è‡ªåŠ¨æ€»ç»“ç»éªŒã€å­¦ä¹ æ–¹æ³•ã€ç»´æŠ¤çŸ¥è¯†åº“
# âœ… é•¿æ¶ˆæ¯åˆ†æ®µ - AIå›å¤è¶…è¿‡4000å­—ç¬¦è‡ªåŠ¨åˆ†é¡µï¼Œä¿ç•™ä»£ç å—
# âœ… ç½‘é¡µæ·±åº¦æµè§ˆ - æ”¯æŒå­é¡µé¢æµè§ˆï¼ŒAPIä¼˜å…ˆæ–¹å¼
# âœ… æ¨¡å—åŒ–æ¶æ„ - core, models, storage, services, handlers
#
# ä¿®å¤é—®é¢˜:
# - ConfigurationError å¯¼å…¥é”™è¯¯ (åœ¨ config.py ä¸­æœ¬åœ°å®šä¹‰)
# - SQLite ä¿ç•™å­— "references" æ”¹ä¸º "ref_data"
# - Gemini æ¨¡å‹åç§°æ”¹ä¸º gemini-3.0-pro-preview
#
# ==============================================================================
#
# éƒ¨ç½²å‰æ£€æŸ¥æ¸…å• (Pre-deployment Checklist):
# âœ… é•œåƒæ¶æ„: linux/amd64
# âœ… é•œåƒå·²æ¨é€åˆ°Docker Hub
# âœ… ç‰ˆæœ¬æ ‡ç­¾ä¸€è‡´
# âœ… ç¯å¢ƒå˜é‡å·²è®¾ç½®
# âœ… .dockerignore å·²é…ç½® (æ’é™¤æ•æ„Ÿæ–‡ä»¶)
#
# ==============================================================================

version: "2.0"

services:
  aisatoshi:
    # é•œåƒç‰ˆæœ¬ - V27-SECURE å®‰å…¨ä¿®å¤ç‰ˆ
    image: pancakekevin911/aisatoshi:v27-secure

    # ç¯å¢ƒå˜é‡ï¼ˆåœ¨éƒ¨ç½²æ—¶æ³¨å…¥å®é™…å€¼ï¼‰
    env:
      # === å¿…éœ€é…ç½® (Required) ===
      # âš ï¸ AI é’±åŒ…ç§é’¥ - è¿™ä¸ªç§é’¥å·²æ³„éœ²ï¼éƒ¨ç½²å‰å¿…é¡»æ›´æ¢ä¸ºæ–°ç§é’¥ï¼
      - AI_PRIVATE_KEY=0xd61a832b7d86cf727dcc2159ea4a0d2652b3fa44a3c0dfbbd88a2ff64b55f718

      # Gemini API å¯†é’¥
      - GEMINI_API_KEY=AIzaSyBDHONk8U2dIwTsyZjRaBM9EIazWjUpKnE

      # Telegram Bot Token
      - TELEGRAM_BOT_TOKEN=7696865066:AAFKdIIJLoFwSzdaJIXdQ4kNVH0p0LkA7yE

      # === å¯é€‰é…ç½® (Optional) ===
      # Moltbook API å¯†é’¥
      - MOLTBOOK_API_KEY=moltbook_sk_FA4mnPQdCG933ndWKYwq3zZ025YppW3e

      # Telegram ç”¨æˆ· Chat ID (å¯é€‰ï¼Œè‡ªåŠ¨æ£€æµ‹)
      - TELEGRAM_USER_ID=

      # === è¿è¡Œé…ç½® ===
      - LOG_LEVEL=INFO

      # æ•°æ®ç›®å½•é…ç½®
      - DATA_DIR=/app/data
      - WORKSPACE_DIR=/app/workspace

      # Gemini æ¨¡å‹é…ç½®
      - GEMINI_MODEL=gemini-3.0-pro-preview
      - GEMINI_TIMEOUT=180

    expose:
      - port: 80
        as: 80
        to:
          - global: true

profiles:
  compute:
    aisatoshi:
      resources:
        cpu:
          units: 0.5
        memory:
          size: 2Gi
        storage:
          size: 2Gi

  placement:
    akash:
      attributes:
        host: akash
      signedBy:
        anyOf:
          - "akash1365yvmc4s7awdyj3n2sav7xfx76adc6dnmlx63"
      pricing:
        aisatoshi:
          denom: uakt
          amount: 5000

deployment:
  aisatoshi:
    akash:
      profile: aisatoshi
      count: 1
